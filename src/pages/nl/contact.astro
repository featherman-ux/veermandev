---
// src/pages/nl/contact.astro
import BaseLayout from '../../layouts/BaseLayout.astro';

const pageTitle = "Contact | VeermanDevelopment";
const pageDescription = "Neem contact met ons op voor een vrijblijvende offerte of kennismakingsgesprek.";
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <!-- Hero Section -->
  <section class="fade-in text-center py-16 bg-card-light dark:bg-card-dark rounded-xl shadow">
    <h1 class="font-heading font-bold text-4xl md:text-5xl mb-6">
      Laten We Samen Iets Geweldigs Bouwen
    </h1>
    <p class="text-lg md:text-xl max-w-3xl mx-auto opacity-80">
      Heb je een project in gedachten? De beste manier om te beginnen is door een vrijblijvend kennismakingsgesprek in te plannen.
    </p>
  </section>

  <!-- Main Content Grid -->
  <section class="fade-in grid lg:grid-cols-2 gap-12 py-16">
    <!-- Calendly Section -->
    <div class="order-2 lg:order-1">
      <div class="bg-card-light dark:bg-card-dark rounded-xl shadow p-6">
        <h2 class="font-heading text-2xl font-semibold mb-4 text-center">
          Plan een Kennismakingsgesprek
        </h2>
        <p class="text-center mb-6 opacity-80">
          Kies hieronder een moment dat jou uitkomt. We bespreken 30 minuten vrijblijvend de mogelijkheden voor je project.
        </p>
        
        <!-- Calendly Embed with proper sizing -->
        <div class="calendly-inline-widget-container">
          <div 
            class="calendly-inline-widget" 
            data-url="https://calendly.com/contact-veermandev/30min?hide_event_type_details=1&primary_color=0a84ff&hide_gdpr_banner=1"
            style="min-width:320px;height:700px;"
            data-resize="true">
          </div>
        </div>
        <script type="text/javascript" src="https://assets.calendly.com/assets/external/widget.js" async></script>
      </div>
    </div>

    <!-- Contact Form Section -->
    <div class="order-1 lg:order-2">
      <div class="bg-card-light dark:bg-card-dark rounded-xl shadow p-6">
        <h2 class="font-heading text-2xl font-semibold mb-4 text-center">
          Of Stuur een Bericht
        </h2>
        <p class="text-center mb-6 opacity-80">
          We nemen zo snel mogelijk contact met je op.
        </p>
        
        <form 
          id="contact-form"
          action="https://formspree.io/f/xdklqakn" 
          method="POST" 
          class="space-y-6"
          data-sending-text="Verzenden..."
          data-success-title="Bedankt!"
          data-success-body="Je bericht is succesvol verzonden. Ik neem zo snel mogelijk contact met je op."
          data-error-text="Er is iets misgegaan bij het verzenden. Probeer het opnieuw."
        >
          <div>
            <label for="name" class="block mb-2 text-sm font-medium">
              Naam
            </label>
            <input 
              type="text" 
              id="name" 
              name="name" 
              placeholder="Je volledige naam" 
              class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary focus:border-transparent transition" 
              required 
            />
          </div>
          
          <div>
            <label for="email" class="block mb-2 text-sm font-medium">
              E-mail
            </label>
            <input 
              type="email" 
              id="email" 
              name="email" 
              placeholder="jij@voorbeeld.com" 
              class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary focus:border-transparent transition" 
              required 
            />
          </div>
          
          <div>
            <label for="message" class="block mb-2 text-sm font-medium">
              Bericht
            </label>
            <textarea 
              id="message" 
              name="message" 
              placeholder="Schrijf hier je bericht..." 
              class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary focus:border-transparent transition" 
              rows="5" 
              required>
            </textarea>
          </div>
          
          <button 
            type="submit" 
            class="w-full bg-primary text-black font-semibold px-6 py-3 rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors"
          >
            Verstuur bericht
          </button>
        </form>
        
        <div id="success-message" class="hidden text-center p-6 border border-green-500 bg-green-50 dark:bg-green-900/20 rounded-lg mt-6">
          <h3 class="font-heading text-xl mb-2 text-green-800 dark:text-green-300">
            Bedankt!
          </h3>
          <p class="text-green-700 dark:text-green-300">
            Je bericht is succesvol verzonden. Ik neem zo snel mogelijk contact met je op.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Info Section -->
  <section class="fade-in py-16">
    <div class="grid md:grid-cols-3 gap-8">
      <div class="p-6 bg-card-light dark:bg-card-dark rounded-xl shadow text-center hover:shadow-lg transition">
        <div class="text-3xl mb-4">ðŸ“§</div>
        <h3 class="text-xl font-semibold mb-2">E-mail</h3>
        <p class="opacity-80">contact@veermandev.nl</p>
      </div>
      
      <div class="p-6 bg-card-light dark:bg-card-dark rounded-xl shadow text-center hover:shadow-lg transition">
        <div class="text-3xl mb-4">âš¡</div>
        <h3 class="text-xl font-semibold mb-2">Snelle Respons</h3>
        <p class="opacity-80">Binnen 24 uur reactie</p>
      </div>
      
      <div class="p-6 bg-card-light dark:bg-card-dark rounded-xl shadow text-center hover:shadow-lg transition">
        <div class="text-3xl mb-4">ðŸš€</div>
        <h3 class="text-xl font-semibold mb-2">Vrijblijvend</h3>
        <p class="opacity-80">Geen verplichtingen</p>
      </div>
    </div>
  </section>

  <style>
    .calendly-inline-widget-container {
      position: relative;
      overflow: hidden;
      border-radius: 8px;
    }
    
    .calendly-inline-widget {
      border-radius: 8px;
    }
    
    /* Ensure proper responsive behavior */
    @media (max-width: 1023px) {
      .calendly-inline-widget {
        min-height: 600px;
      }
    }
    
    @media (min-width: 1024px) {
      .calendly-inline-widget {
        min-height: 700px;
      }
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('contact-form') as HTMLFormElement;
      const successMessage = document.getElementById('success-message');

      if (form && successMessage) {
        form.addEventListener('submit', function(e) {
          e.preventDefault();
          const submitButton = form.querySelector('button[type="submit"]') as HTMLButtonElement;
          const originalButtonText = submitButton.innerHTML;
          
          const sendingText = form.dataset.sendingText || 'Verzenden...';
          const errorText = form.dataset.errorText || 'Er is een fout opgetreden.';
          
          submitButton.disabled = true;
          submitButton.innerHTML = sendingText;

          const formData = new FormData(form);
          
          fetch(form.action, {
            method: 'POST',
            body: formData,
            headers: {
                'Accept': 'application/json'
            }
          }).then(response => {
            if (response.ok) {
              form.style.display = 'none';
              successMessage.style.display = 'block';
            } else {
              response.json().then(data => {
                if (Object.hasOwn(data, 'errors')) {
                  alert(data["errors"].map((error: { message: string }) => error["message"]).join(", "));
                } else {
                  alert(errorText);
                }
              })
              submitButton.disabled = false;
              submitButton.innerHTML = originalButtonText;
            }
          }).catch((error: any) => {
            alert(errorText);
            submitButton.disabled = false;
            submitButton.innerHTML = originalButtonText;
          });
        });
      }
    });
  </script>
</BaseLayout>
