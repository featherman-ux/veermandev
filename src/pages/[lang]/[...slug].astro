---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { ui, routes } from '../../i18n/config';
import { getLangFromUrl } from '../../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const { slug = routes[lang].home } = Astro.params as { slug?: string };

// Validate language
if (!(lang in ui)) {
  return Astro.redirect('/404', 404);
}

// Redirect contact
if (slug === routes[lang].contact) {
  return Astro.redirect(`/${lang}/${routes[lang].contact}`, 307);
}

// Redirect old process slug to timeline
if (
  slug === routes[lang].process ||
  slug === 'proces' ||
  slug === 'werkwijze'
) {
  return Astro.redirect(`/${lang}/${routes[lang].timeline}`, 307);
}

// --- Page Titles & Descriptions ---
const pageTitles: Record<string, Record<string, string>> = {
  nl: {
    [routes.nl.home]: 'Home',
    [routes.nl.about]: 'Over Ons',
    [routes.nl.portfolio]: 'Portfolio',
    [routes.nl.pricing]: 'Prijzen',
    [routes.nl.timeline]: 'Onze Werkwijze',
    [routes.nl.technology]: 'Onze Technologie',
  },
  en: {
    [routes.en.home]: 'Home',
    [routes.en.about]: 'About Us',
    [routes.en.portfolio]: 'Portfolio',
    [routes.en.pricing]: 'Pricing',
    [routes.en.timeline]: 'Our Process',
    [routes.en.technology]: 'Our Technology',
  },
};

const pageDescriptions: Record<string, Record<string, string>> = {
  nl: {
    [routes.nl.home]: 'Welkom bij VeermanDevelopment – digitale oplossingen voor bedrijven.',
    [routes.nl.about]: 'Maak kennis met ons team en onze expertise.',
    [routes.nl.portfolio]: 'Bekijk onze projecten en cases.',
    [routes.nl.pricing]: 'Ontdek onze tarieven en pakketten.',
    [routes.nl.timeline]: 'Uw site live in drie dagen—transparante vijf-stappen werkwijze.',
    [routes.nl.technology]: 'Waarom Jamstack en Astro superieure snelheid, veiligheid en schaalbaarheid bieden.',
  },
  en: {
    [routes.en.home]: 'Welcome to VeermanDevelopment – digital solutions for businesses.',
    [routes.en.about]: 'Meet our team and discover our expertise.',
    [routes.en.portfolio]: 'Explore our projects and cases.',
    [routes.en.pricing]: 'Discover our pricing and packages.',
    [routes.en.timeline]: 'Your site live in just three days—transparent five-step journey.',
    [routes.en.technology]: 'Why Jamstack and Astro deliver superior speed, security, and scalability.',
  },
};

// Redirect unknown slugs to home
if (!(slug in pageTitles[lang])) {
  return Astro.redirect(`/${lang}/${routes[lang].home}`, 307);
}

const title = pageTitles[lang][slug];
const description = pageDescriptions[lang][slug];
---

<BaseLayout title={title} description={description}>
  <section class="container mx-auto py-12 px-6 fade-in">
    <h1 class="text-4xl md:text-5xl font-heading font-bold mb-6">{title}</h1>
    <p class="text-lg md:text-xl text-opacity-80 mb-8">{description}</p>

    <div class="prose dark:prose-invert lg:prose-xl max-w-none">
      {slug === routes[lang].about && (
        <>
          <p>
            {lang === 'nl'
              ? 'Wij zijn een team van ervaren ontwikkelaars, ontwerpers en data-specialisten die digitale oplossingen creëren voor bedrijven van elke omvang.'
              : 'We are a team of experienced developers, designers, and data specialists creating digital solutions for businesses of all sizes.'}
          </p>
          <p>
            {lang === 'nl'
              ? 'Onze focus ligt op performance, schaalbaarheid en moderne webstandaarden, zodat elke website toekomstbestendig is.'
              : 'Our focus is on performance, scalability, and modern web standards, ensuring every website is future-proof.'}
          </p>
        </>
      )}

      {slug === routes[lang].portfolio && (
        <p>
          {lang === 'nl'
            ? 'Hier presenteren we onze recente projecten.'
            : 'Here we showcase our recent projects.'}
        </p>
      )}

      {slug === routes[lang].pricing && (
        <p>
          {lang === 'nl'
            ? 'Bekijk onze transparante en eerlijke tarieven.'
            : 'Check out our transparent and fair pricing.'}
        </p>
      )}

      {slug === routes[lang].timeline && (
        <p>
          {lang === 'nl'
            ? 'Uw site live in drie dagen—volg ons transparante vijf-stappen plan.'
            : 'Your site live in just three days—follow our transparent five-step plan.'}
        </p>
      )}

      {slug === routes[lang].technology && (
        <p>
          {lang === 'nl'
            ? "Pre-rendered pagina's, beveiligingsvoordelen en schaalbare CDN-hosting."
            : 'Pre-rendered pages, security advantages, and scalable CDN hosting.'}
        </p>
      )}
    </div>
  </section>
</BaseLayout>
